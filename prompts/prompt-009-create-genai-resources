create the Azure resources needed for a generative AI chat user interface including any new azure resource IaC, 
endpoints, keys etc but make sure to use the managed identity you already created

use low cost S0 SKUs where possible (for Azure Open AI and Cognitivie services) 
and always use the "GPT-4o" model in "Sweden" even if the resrouce group is "UKSOUTH" do not use any other models

store the settings for these new resources in a GenAISettings file.

Azure role assignments require the Principal ID (a GUID), not the resource ID. The Principal ID is available as managedIdentity.properties.principalId.

You need to:

Output the principalId from app-service.bicep
Pass it to genai.bicep
Use it in the role assignments
